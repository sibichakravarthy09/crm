"use strict";(self.webpackChunkcrm=self.webpackChunkcrm||[]).push([[2137],{9565:(e,a,l)=>{l.d(a,{A:()=>g});var o=l(8460),i=l(1054),t=l(5421),s=l(5071),n=l(5929),r=l(7516),d=l(5371),c=l(6529),u=l(9301),x=l(5043),m=l(1046),p=l(9621),h=l(9488),v=l(8860),j=l(579);const g=e=>{const{onClose:a,isOpen:l,fieldName:g,setFieldValue:f}=e,[y,S]=(0,x.useState)(),[b,C]=(0,x.useState)(!1),[w,B]=(0,x.useState)([]),E=JSON.parse(localStorage.getItem("user"));return(0,x.useEffect)((()=>{(async()=>{C(!0);let e=await(0,p.x4)("admin"===E.role?"api/contact/":`api/contact/?createBy=${E._id}`);e&&200==e.status&&B(null===e||void 0===e?void 0:e.data),C(!1)})()}),[]),(0,j.jsxs)(o.aF,{onClose:a,size:"full",isOpen:l,children:[(0,j.jsx)(i.m,{}),(0,j.jsxs)(t.$,{children:[(0,j.jsx)(s.r,{children:"Select Contact"}),(0,j.jsx)(n.s,{}),(0,j.jsx)(r.c,{children:b?(0,j.jsx)(d.s,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,j.jsx)(h.A,{})}):(0,j.jsx)(m.A,{tableData:w,selectedValues:y,setSelectedValues:S,columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"title",accessor:"title"},{Header:"first Name",accessor:"firstName"},{Header:"last Name",accessor:"lastName"},{Header:"phone Number",accessor:"phoneNumber"},{Header:"Email Address",accessor:"email"},{Header:"physical Address",accessor:"physicalAddress"},{Header:"mailing Address",accessor:"mailingAddress"},{Header:"Contact Method",accessor:"preferredContactMethod"}],title:"Contact"})}),(0,j.jsxs)(c.j,{children:[(0,j.jsxs)(u.$,{variant:"brand",onClick:async()=>{try{C(!0),f(g,y),a()}catch(e){console.log(e)}finally{C(!1)}},disabled:!!b,leftIcon:(0,j.jsx)(v.NLY,{}),children:[" ",b?(0,j.jsx)(h.A,{}):"Select"]}),(0,j.jsx)(u.$,{onClick:()=>a(),children:"Close"})]})]})]})}},1125:(e,a,l)=>{l.d(a,{A:()=>g});var o=l(8460),i=l(1054),t=l(5421),s=l(5071),n=l(5929),r=l(7516),d=l(5371),c=l(6529),u=l(9301),x=l(5043),m=l(7214),p=l(9621),h=l(9488),v=l(8860),j=l(579);const g=e=>{const{onClose:a,isOpen:l,fieldName:g,setFieldValue:f}=e,[y,S]=(0,x.useState)(),[b,C]=(0,x.useState)(!1),[w,B]=(0,x.useState)([]),E=JSON.parse(localStorage.getItem("user"));return(0,x.useEffect)((()=>{(async()=>{C(!0);let e=await(0,p.x4)("admin"===E.role?"api/lead/":`api/lead/?createBy=${E._id}`);e&&200==e.status&&B(null===e||void 0===e?void 0:e.data),C(!1)})()}),[]),(0,j.jsxs)(o.aF,{onClose:a,size:"full",isOpen:l,children:[(0,j.jsx)(i.m,{}),(0,j.jsxs)(t.$,{children:[(0,j.jsx)(s.r,{children:"Select Lead"}),(0,j.jsx)(n.s,{}),(0,j.jsx)(r.c,{children:b?(0,j.jsx)(d.s,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,j.jsx)(h.A,{})}):(0,j.jsx)(m.A,{tableData:w,selectedValues:y,setSelectedValues:S,columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"Lead Name",accessor:"leadName",width:20},{Header:"Lead Email",accessor:"leadEmail"},{Header:"Lead PhoneNumber",accessor:"leadPhoneNumber"},{Header:"Lead Address",accessor:"leadAddress"},{Header:"Lead Status",accessor:"leadStatus"},{Header:"Lead Owner",accessor:"leadOwner"},{Header:"Lead Score",accessor:"leadScore"}],title:"Lead"})}),(0,j.jsxs)(c.j,{children:[(0,j.jsxs)(u.$,{variant:"brand",onClick:async()=>{try{C(!0),f(g,y),a()}catch(e){console.log(e)}finally{C(!1)}},disabled:!!b,leftIcon:(0,j.jsx)(v.NLY,{}),children:[" ",b?(0,j.jsx)(h.A,{}):"Select"]}),(0,j.jsx)(u.$,{onClick:()=>a(),children:"Close"})]})]})]})}},3332:(e,a,l)=>{l.r(a),l.d(a,{default:()=>q});var o=l(6870),i=l(3533),t=l(5527),s=l(9301),n=l(4093),r=l(5371),d=l(9081),c=l(2107),u=l(511),x=l(3313),m=l(5395),p=l(3201),h=l(2595),v=l(7813),j=l(5043),g=l(1094),f=l(216),y=l(5369),S=l(5475),b=l(6914),C=l(100),w=l(9488),B=l(6178),E=l.n(B),N=l(9621),H=l(579);function A(e){const{columnsData:a}=e,l=(0,n.dU)("secondaryGray.900","white"),o=(0,n.dU)("gray.200","whiteAlpha.100"),i=(0,j.useMemo)((()=>a),[a]),[t,s]=(0,j.useState)([]),B=JSON.parse(localStorage.getItem("user")),[A,L]=(0,j.useState)(!1),[z,P]=(0,j.useState)(),W=(0,g.useTable)({columns:i,data:t,initialState:{pageIndex:0}},g.useGlobalFilter,g.useSortBy,g.usePagination),{getTableProps:$,getTableBodyProps:T,headerGroups:O,prepareRow:V,page:_,canPreviousPage:k,canNextPage:D,pageOptions:I,pageCount:R,gotoPage:F,nextPage:M,previousPage:G,setPageSize:J,state:{pageIndex:X,pageSize:Y}}=W;return I.length<z&&P(I.length),(0,j.useEffect)((()=>{(async()=>{L(!0);let e=await(0,N.x4)("admin"===B.role?"api/email/":`api/email/?sender=${B._id}`);s(null===e||void 0===e?void 0:e.data),L(!1)})()}),[e.isOpen]),(0,H.jsxs)(f.A,{direction:"column",w:"100%",px:"0px",overflowX:{sm:"scroll",lg:"hidden"},children:[(0,H.jsx)(r.s,{px:"25px",justify:"space-between",mb:"20px",align:"center",children:(0,H.jsxs)(d.E,{color:l,fontSize:"22px",fontWeight:"700",lineHeight:"100%",children:["Emails (",(0,H.jsx)(b.A,{targetNumber:null===t||void 0===t?void 0:t.length}),")"]})}),(0,H.jsx)(c.a,{overflowY:"auto",className:"table-fix-container",children:(0,H.jsxs)(u.X,{...$(),variant:"simple",color:"gray.500",mb:"24px",children:[(0,H.jsx)(x.d,{children:null===O||void 0===O?void 0:O.map(((e,a)=>{var l;return(0,j.createElement)(m.Tr,{...e.getHeaderGroupProps(),key:a},null===(l=e.headers)||void 0===l?void 0:l.map(((e,a)=>(0,j.createElement)(p.Th,{...e.getHeaderProps(!1!==e.isSortable&&e.getSortByToggleProps()),pe:"10px",key:a,borderColor:o},(0,H.jsxs)(r.s,{justify:"space-between",align:"center",fontSize:{sm:"10px",lg:"12px"},color:"gray.400",children:[e.render("Header"),!1!==e.isSortable&&(0,H.jsx)("span",{children:e.isSorted?e.isSortedDesc?(0,H.jsx)(y.GOR,{}):(0,H.jsx)(y.XhJ,{}):(0,H.jsx)(y.MjW,{})})]})))))}))}),(0,H.jsx)(h.N,{...T(),children:A?(0,H.jsx)(m.Tr,{children:(0,H.jsx)(v.Td,{colSpan:null===i||void 0===i?void 0:i.length,children:(0,H.jsx)(r.s,{justifyContent:"center",alignItems:"center",width:"100%",color:l,fontSize:"sm",fontWeight:"700",children:(0,H.jsx)(w.A,{})})})}):0===(null===t||void 0===t?void 0:t.length)?(0,H.jsx)(m.Tr,{children:(0,H.jsx)(v.Td,{colSpan:i.length,children:(0,H.jsx)(d.E,{textAlign:"center",width:"100%",color:l,fontSize:"sm",fontWeight:"700",children:"-- No Data Found --"})})}):null===_||void 0===_?void 0:_.map(((e,a)=>{var o;return V(e),(0,j.createElement)(m.Tr,{...null===e||void 0===e?void 0:e.getRowProps(),key:a},null===e||void 0===e||null===(o=e.cells)||void 0===o?void 0:o.map(((e,a)=>{let o="";var i;if("#"===(null===e||void 0===e?void 0:e.column.Header))o=(0,H.jsx)(r.s,{align:"center",children:(0,H.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e||null===(i=e.row)||void 0===i?void 0:i.index)+1})});else if("sender Name"===(null===e||void 0===e?void 0:e.column.Header))o=(0,H.jsx)(d.E,{me:"10px",color:l,fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&e.value?null===e||void 0===e?void 0:e.value:" - "});else if("recipient"===(null===e||void 0===e?void 0:e.column.Header)){var t,s;o=(0,H.jsx)(S.N_,{to:"admin"!==(null===B||void 0===B?void 0:B.role)?`/Email/${null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.values._id}`:`/admin/Email/${null===e||void 0===e||null===(s=e.row)||void 0===s?void 0:s.values._id}`,children:(0,H.jsx)(d.E,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"green.400",fontSize:"sm",fontWeight:"700",children:null===e||void 0===e?void 0:e.value})})}else if("Realeted To"===(null===e||void 0===e?void 0:e.column.Header)){var n,c,u,x,m,p,h,g;o=(0,H.jsx)(S.N_,{to:null!==e&&void 0!==e&&null!==(n=e.row)&&void 0!==n&&null!==(c=n.original)&&void 0!==c&&c.createBy?"admin"!==(null===B||void 0===B?void 0:B.role)?`/contactView/${null===e||void 0===e||null===(u=e.row)||void 0===u?void 0:u.original.createBy}`:`/admin/contactView/${null===e||void 0===e||null===(x=e.row)||void 0===x?void 0:x.original.createBy}`:"admin"!==(null===B||void 0===B?void 0:B.role)?`/leadView/${null===e||void 0===e||null===(m=e.row)||void 0===m?void 0:m.original.createByLead}`:`/admin/leadView/${null===e||void 0===e||null===(p=e.row)||void 0===p?void 0:p.original.createByLead}`,children:(0,H.jsx)(d.E,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"green.400",fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&null!==(h=e.row)&&void 0!==h&&h.original.createBy?"contact":(null===e||void 0===e||null===(g=e.row)||void 0===g?void 0:g.original.createByLead)&&"lead"})})}else if("timestamp"===(null===e||void 0===e?void 0:e.column.Header))o=(0,H.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:E()(null===e||void 0===e?void 0:e.value).toNow()});else if("Created"===(null===e||void 0===e?void 0:e.column.Header)){var f;o=(0,H.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:E()(null===e||void 0===e||null===(f=e.row)||void 0===f?void 0:f.values.timestamp).format("(DD/MM) h:mma")})}return(0,j.createElement)(v.Td,{...null===e||void 0===e?void 0:e.getCellProps(),key:a,fontSize:{sm:"14px"},minW:{sm:"150px",md:"200px",lg:"auto"},borderColor:"transparent"},o)})))}))})]})}),(null===t||void 0===t?void 0:t.length)>5&&(0,H.jsx)(C.A,{gotoPage:F,gopageValue:z,setGopageValue:P,pageCount:R,canPreviousPage:k,previousPage:G,canNextPage:D,pageOptions:I,setPageSize:J,nextPage:M,pageSize:Y,pageIndex:X})]})}var L=l(7492),z=l(8460),P=l(1054),W=l(5421),$=l(5071),T=l(5929),O=l(7516),V=l(6668),_=l(6686),k=l(9904),D=l(4812),I=l(1724),R=l(2703),F=l(5699),M=l(9077),G=l(6529),J=l(9565),X=l(1125),Y=l(3516),K=l(3388),U=l(6092);const Z=e=>{const{onClose:a,isOpen:l,fetchData:o}=e,[n,c]=(0,j.useState)(!1),[u,x]=(0,j.useState)([]),[m,p]=(0,j.useState)(!1),[h,v]=(0,j.useState)(!1),g=JSON.parse(localStorage.getItem("user")),f={sender:null===g||void 0===g?void 0:g._id,recipient:"",subject:"",callNotes:"",createBy:"",createByLead:"",startDate:new Date,endDate:"",category:"contact",assignmentTo:"",assignmentToLead:"",message:""},y=(0,Y.Wx)({initialValues:f,validationSchema:U.y4,onSubmit:async(e,a)=>{let{resetForm:l}=a;await Z(e),l()}}),{errors:S,touched:b,values:C,handleBlur:B,handleChange:E,handleSubmit:A,setFieldValue:L}=y,Z=async a=>{try{c(!0);let l=await(0,N.d_)("api/email/add",a);200===l.status?(e.onClose(),o()):console.error("Error:",l)}catch(l){console.error("API Error:",l)}finally{c(!1)}};(0,j.useEffect)((()=>{(async()=>{C.start=null===e||void 0===e?void 0:e.date;try{var a;let e;"contact"===C.category?e=await(0,N.x4)("admin"===g.role?"api/contact/":`api/contact/?createBy=${g._id}`):"lead"===C.category&&(e=await(0,N.x4)("admin"===g.role?"api/lead/":`api/lead/?createBy=${g._id}`)),x(null===(a=e)||void 0===a?void 0:a.data)}catch(l){console.error("Fetch Assignment Data Error:",l)}})()}),[e,C.category]);return(0,j.useEffect)((()=>{(async()=>{if(C.createBy){let i=await(0,N.x4)("api/contact/view/",C.createBy);var e,a,l,o;200===(null===i||void 0===i?void 0:i.status)&&(L("recipient",null===i||void 0===i||null===(e=i.data)||void 0===e||null===(a=e.contact)||void 0===a?void 0:a.email),C.recipient=null===i||void 0===i||null===(l=i.data)||void 0===l||null===(o=l.contact)||void 0===o?void 0:o.email)}else if(C.createByLead){let e=await(0,N.x4)("api/lead/view/",C.createByLead);var i,t,s,n;200===(null===e||void 0===e?void 0:e.status)&&(L("recipient",null===e||void 0===e||null===(i=e.data)||void 0===i||null===(t=i.lead)||void 0===t?void 0:t.leadEmail),C.recipient=null===e||void 0===e||null===(s=e.data)||void 0===s||null===(n=s.lead)||void 0===n?void 0:n.leadEmail)}})()}),[C.createBy,C.createByLead]),(0,H.jsxs)(z.aF,{onClose:a,isOpen:l,isCentered:!0,children:[(0,H.jsx)(P.m,{}),(0,H.jsxs)(W.$,{children:[(0,H.jsx)($.r,{children:"Add Email"}),(0,H.jsx)(T.s,{}),(0,H.jsxs)(O.c,{children:[(0,H.jsx)(J.A,{isOpen:m,onClose:p,fieldName:"createBy",setFieldValue:L}),(0,H.jsx)(X.A,{isOpen:h,onClose:v,fieldName:"createByLead",setFieldValue:L}),(0,H.jsxs)(i.x,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,H.jsxs)(t.E,{colSpan:{base:12,md:6},children:[(0,H.jsx)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Related"}),(0,H.jsx)(_.z,{onChange:e=>{L("category",e),L("createBy",""),L("createByLead","")},value:C.category,children:(0,H.jsxs)(k.B,{direction:"row",children:[(0,H.jsx)(D.s,{value:"contact",children:"Contact"}),(0,H.jsx)(D.s,{value:"lead",children:"Lead"})]})}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.category&&b.category&&S.category})]}),(0,H.jsx)(t.E,{colSpan:{base:12},children:"contact"===C.category?(0,H.jsxs)(t.E,{colSpan:{base:12,md:6},children:[(0,H.jsx)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Contact)"}),(0,H.jsxs)(r.s,{justifyContent:"space-between",children:[(0,H.jsx)(I.l,{value:C.createBy,name:"createBy",onChange:E,mb:S.createBy&&b.createBy?void 0:"10px",fontWeight:"500",placeholder:"Assignment To",borderColor:S.createBy&&b.createBy?"red.300":null,children:null===u||void 0===u?void 0:u.map((e=>(0,H.jsx)("option",{value:e._id,children:`${e.firstName} ${e.lastName}`},e._id)))}),(0,H.jsx)(R.K,{onClick:()=>p(!0),ml:2,fontSize:"25px",icon:(0,H.jsx)(K.G2h,{})})]}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.createBy&&b.createBy&&S.createBy})]}):"lead"===C.category?(0,H.jsxs)(t.E,{colSpan:{base:12,md:6},children:[(0,H.jsx)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Lead)"}),(0,H.jsxs)(r.s,{justifyContent:"space-between",children:[(0,H.jsx)(I.l,{value:C.createByLead,name:"createByLead",onChange:E,mb:S.createByLead&&b.createByLead?void 0:"10px",fontWeight:"500",placeholder:"Assignment To",borderColor:S.createByLead&&b.createByLead?"red.300":null,children:null===u||void 0===u?void 0:u.map((e=>(0,H.jsx)("option",{value:e._id,children:e.leadName},e._id)))}),(0,H.jsx)(R.K,{onClick:()=>v(!0),ml:2,fontSize:"25px",icon:(0,H.jsx)(K.G2h,{})})]}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.createByLead&&b.createByLead&&S.createByLead})]}):null}),(0,H.jsxs)(t.E,{colSpan:{base:12},children:[(0,H.jsxs)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Recipient",(0,H.jsx)(d.E,{color:"red",children:"*"})]}),(0,H.jsx)(F.p,{fontSize:"sm",disabled:!0,value:C.recipient,name:"recipient",placeholder:"Recipient",fontWeight:"500",borderColor:S.recipient&&b.recipient?"red.300":null}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.recipient&&b.recipient&&S.recipient})]}),(0,H.jsxs)(t.E,{colSpan:{base:12},children:[(0,H.jsxs)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Subject",(0,H.jsx)(d.E,{color:"red",children:"*"})]}),(0,H.jsx)(F.p,{fontSize:"sm",onChange:E,onBlur:B,value:C.subject,name:"subject",placeholder:"Subject",fontWeight:"500",borderColor:S.subject&&b.subject?"red.300":null}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.subject&&b.subject&&S.subject})]}),(0,H.jsxs)(t.E,{colSpan:{base:12},children:[(0,H.jsx)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Call Notes"}),(0,H.jsx)(M.T,{onChange:E,onBlur:B,value:C.callNotes,name:"callNotes",placeholder:"Call Notes",fontWeight:"500",borderColor:S.callNotes&&b.callNotes?"red.300":null}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.callNotes&&b.callNotes&&S.callNotes})]}),(0,H.jsxs)(t.E,{colSpan:{base:12},children:[(0,H.jsx)(V.l,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Message"}),(0,H.jsx)(M.T,{onChange:E,onBlur:B,value:C.message,name:"message",placeholder:"Message",fontWeight:"500",borderColor:S.message&&b.message?"red.300":null}),(0,H.jsx)(d.E,{mb:"10px",color:"red",children:S.message&&b.message&&S.message})]})]})]}),(0,H.jsxs)(G.j,{children:[(0,H.jsx)(s.$,{variant:"outline",mr:3,onClick:a,children:"Cancel"}),(0,H.jsx)(s.$,{colorScheme:"teal",onClick:A,isLoading:n,children:n?(0,H.jsx)(w.A,{}):"Send Email"})]})]})]})},q=()=>{const{isOpen:e,onOpen:a,onClose:l}=(0,o.j)();return(0,H.jsxs)("div",{children:[(0,H.jsx)(i.x,{templateColumns:"repeat(6, 1fr)",mb:3,gap:1,children:(0,H.jsx)(t.E,{colStart:6,textAlign:"right",children:(0,H.jsx)(s.$,{onClick:()=>{a()},leftIcon:(0,H.jsx)(L.R,{}),variant:"brand",children:"Add"})})}),(0,H.jsx)(A,{columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"Sender Name",accessor:"senderName"},{Header:"Recipient",accessor:"createByName"},{Header:"Related To",accessor:"relatedTo"},{Header:"Timestamp",accessor:"timestamp"},{Header:"Created",accessor:"created"}]}),(0,H.jsx)(Z,{isOpen:e,size:"lg",onClose:l})]})}},7492:(e,a,l)=>{l.d(a,{R:()=>o});const o=(0,l(4010).w)({d:"M0,12a1.5,1.5,0,0,0,1.5,1.5h8.75a.25.25,0,0,1,.25.25V22.5a1.5,1.5,0,0,0,3,0V13.75a.25.25,0,0,1,.25-.25H22.5a1.5,1.5,0,0,0,0-3H13.75a.25.25,0,0,1-.25-.25V1.5a1.5,1.5,0,0,0-3,0v8.75a.25.25,0,0,1-.25.25H1.5A1.5,1.5,0,0,0,0,12Z",displayName:"AddIcon"})}}]);
//# sourceMappingURL=2137.e13c8be4.chunk.js.map
"use strict";(self.webpackChunkcrm=self.webpackChunkcrm||[]).push([[1929],{9565:(e,a,l)=>{l.d(a,{A:()=>j});var t=l(8460),n=l(1054),o=l(5421),i=l(5071),r=l(5929),s=l(7516),d=l(5371),c=l(6529),u=l(9301),h=l(5043),x=l(1046),m=l(9621),p=l(9488),v=l(8860),g=l(579);const j=e=>{const{onClose:a,isOpen:l,fieldName:j,setFieldValue:f}=e,[S,y]=(0,h.useState)(),[C,b]=(0,h.useState)(!1),[w,B]=(0,h.useState)([]),N=JSON.parse(localStorage.getItem("user"));return(0,h.useEffect)((()=>{(async()=>{b(!0);let e=await(0,m.x4)("admin"===N.role?"api/contact/":`api/contact/?createBy=${N._id}`);e&&200==e.status&&B(null===e||void 0===e?void 0:e.data),b(!1)})()}),[]),(0,g.jsxs)(t.aF,{onClose:a,size:"full",isOpen:l,children:[(0,g.jsx)(n.m,{}),(0,g.jsxs)(o.$,{children:[(0,g.jsx)(i.r,{children:"Select Contact"}),(0,g.jsx)(r.s,{}),(0,g.jsx)(s.c,{children:C?(0,g.jsx)(d.s,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,g.jsx)(p.A,{})}):(0,g.jsx)(x.A,{tableData:w,selectedValues:S,setSelectedValues:y,columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"title",accessor:"title"},{Header:"first Name",accessor:"firstName"},{Header:"last Name",accessor:"lastName"},{Header:"phone Number",accessor:"phoneNumber"},{Header:"Email Address",accessor:"email"},{Header:"physical Address",accessor:"physicalAddress"},{Header:"mailing Address",accessor:"mailingAddress"},{Header:"Contact Method",accessor:"preferredContactMethod"}],title:"Contact"})}),(0,g.jsxs)(c.j,{children:[(0,g.jsxs)(u.$,{variant:"brand",onClick:async()=>{try{b(!0),f(j,S),a()}catch(e){console.log(e)}finally{b(!1)}},disabled:!!C,leftIcon:(0,g.jsx)(v.NLY,{}),children:[" ",C?(0,g.jsx)(p.A,{}):"Select"]}),(0,g.jsx)(u.$,{onClick:()=>a(),children:"Close"})]})]})]})}},1125:(e,a,l)=>{l.d(a,{A:()=>j});var t=l(8460),n=l(1054),o=l(5421),i=l(5071),r=l(5929),s=l(7516),d=l(5371),c=l(6529),u=l(9301),h=l(5043),x=l(7214),m=l(9621),p=l(9488),v=l(8860),g=l(579);const j=e=>{const{onClose:a,isOpen:l,fieldName:j,setFieldValue:f}=e,[S,y]=(0,h.useState)(),[C,b]=(0,h.useState)(!1),[w,B]=(0,h.useState)([]),N=JSON.parse(localStorage.getItem("user"));return(0,h.useEffect)((()=>{(async()=>{b(!0);let e=await(0,m.x4)("admin"===N.role?"api/lead/":`api/lead/?createBy=${N._id}`);e&&200==e.status&&B(null===e||void 0===e?void 0:e.data),b(!1)})()}),[]),(0,g.jsxs)(t.aF,{onClose:a,size:"full",isOpen:l,children:[(0,g.jsx)(n.m,{}),(0,g.jsxs)(o.$,{children:[(0,g.jsx)(i.r,{children:"Select Lead"}),(0,g.jsx)(r.s,{}),(0,g.jsx)(s.c,{children:C?(0,g.jsx)(d.s,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,g.jsx)(p.A,{})}):(0,g.jsx)(x.A,{tableData:w,selectedValues:S,setSelectedValues:y,columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"Lead Name",accessor:"leadName",width:20},{Header:"Lead Email",accessor:"leadEmail"},{Header:"Lead PhoneNumber",accessor:"leadPhoneNumber"},{Header:"Lead Address",accessor:"leadAddress"},{Header:"Lead Status",accessor:"leadStatus"},{Header:"Lead Owner",accessor:"leadOwner"},{Header:"Lead Score",accessor:"leadScore"}],title:"Lead"})}),(0,g.jsxs)(c.j,{children:[(0,g.jsxs)(u.$,{variant:"brand",onClick:async()=>{try{b(!0),f(j,S),a()}catch(e){console.log(e)}finally{b(!1)}},disabled:!!C,leftIcon:(0,g.jsx)(v.NLY,{}),children:[" ",C?(0,g.jsx)(p.A,{}):"Select"]}),(0,g.jsx)(u.$,{onClick:()=>a(),children:"Close"})]})]})]})}},3652:(e,a,l)=>{l.r(a),l.d(a,{default:()=>q});var t=l(6870),n=l(3533),o=l(5527),i=l(9301),r=l(4093),s=l(5371),d=l(9081),c=l(2107),u=l(511),h=l(3313),x=l(5395),m=l(3201),p=l(2595),v=l(7813),g=l(5043),j=l(1094),f=l(216),S=l(5369),y=l(5475),C=l(6914),b=l(100),w=l(9488),B=l(6178),N=l.n(B),D=l(9621),E=l(579);function H(e){const{columnsData:a}=e,l=(0,r.dU)("secondaryGray.900","white"),t=(0,r.dU)("gray.200","whiteAlpha.100"),n=(0,g.useMemo)((()=>a),[a]),[o,i]=(0,g.useState)([]),B=JSON.parse(localStorage.getItem("user")),[H,z]=(0,g.useState)(!1),[A,L]=(0,g.useState)(),W=(0,j.useTable)({columns:n,data:o,initialState:{pageIndex:0}},j.useGlobalFilter,j.useSortBy,j.usePagination),{getTableProps:P,getTableBodyProps:$,headerGroups:O,prepareRow:T,page:V,canPreviousPage:_,canNextPage:k,pageOptions:I,pageCount:R,gotoPage:F,nextPage:G,previousPage:M,setPageSize:J,state:{pageIndex:X,pageSize:Y}}=W;return I.length<A&&L(I.length),(0,g.useEffect)((()=>{(async()=>{z(!0);let e=await(0,D.x4)("admin"===B.role?"api/phoneCall":`api/phoneCall?sender=${B._id}`);i(null===e||void 0===e?void 0:e.data),z(!1)})()}),[e.isOpen]),(0,E.jsxs)(f.A,{direction:"column",w:"100%",px:"0px",overflowX:{sm:"scroll",lg:"hidden"},children:[(0,E.jsx)(s.s,{px:"25px",justify:"space-between",mb:"20px",align:"center",children:(0,E.jsxs)(d.E,{color:l,fontSize:"22px",fontWeight:"700",lineHeight:"100%",children:["Calls (",(0,E.jsx)(C.A,{targetNumber:null===o||void 0===o?void 0:o.length}),")"]})}),(0,E.jsx)(c.a,{overflowY:"auto",className:"table-fix-container",children:(0,E.jsxs)(u.X,{...P(),variant:"simple",color:"gray.500",mb:"24px",children:[(0,E.jsx)(h.d,{children:null===O||void 0===O?void 0:O.map(((e,a)=>{var l;return(0,g.createElement)(x.Tr,{...e.getHeaderGroupProps(),key:a},null===(l=e.headers)||void 0===l?void 0:l.map(((e,a)=>(0,g.createElement)(m.Th,{...e.getHeaderProps(!1!==e.isSortable&&e.getSortByToggleProps()),pe:"10px",key:a,borderColor:t},(0,E.jsxs)(s.s,{justify:"space-between",align:"center",fontSize:{sm:"10px",lg:"12px"},color:"gray.400",children:[e.render("Header"),!1!==e.isSortable&&(0,E.jsx)("span",{children:e.isSorted?e.isSortedDesc?(0,E.jsx)(S.GOR,{}):(0,E.jsx)(S.XhJ,{}):(0,E.jsx)(S.MjW,{})})]})))))}))}),(0,E.jsx)(p.N,{...$(),children:H?(0,E.jsx)(x.Tr,{children:(0,E.jsx)(v.Td,{colSpan:null===n||void 0===n?void 0:n.length,children:(0,E.jsx)(s.s,{justifyContent:"center",alignItems:"center",width:"100%",color:l,fontSize:"sm",fontWeight:"700",children:(0,E.jsx)(w.A,{})})})}):0===(null===o||void 0===o?void 0:o.length)?(0,E.jsx)(x.Tr,{children:(0,E.jsx)(v.Td,{colSpan:n.length,children:(0,E.jsx)(d.E,{textAlign:"center",width:"100%",color:l,fontSize:"sm",fontWeight:"700",children:"-- No Data Found --"})})}):null===V||void 0===V?void 0:V.map(((e,a)=>{var t;return T(e),(0,g.createElement)(x.Tr,{...null===e||void 0===e?void 0:e.getRowProps(),key:a},null===e||void 0===e||null===(t=e.cells)||void 0===t?void 0:t.map(((e,a)=>{let t="";var n;if("#"===(null===e||void 0===e?void 0:e.column.Header))t=(0,E.jsx)(s.s,{align:"center",children:(0,E.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e||null===(n=e.row)||void 0===n?void 0:n.index)+1})});else if("sender"===(null===e||void 0===e?void 0:e.column.Header)){var o,i;t=(0,E.jsx)(y.N_,{to:"admin"!==(null===B||void 0===B?void 0:B.role)?`/phone-call/${null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.values._id}`:`/admin/phone-call/${null===e||void 0===e||null===(i=e.row)||void 0===i?void 0:i.values._id}`,children:(0,E.jsx)(d.E,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"green.400",fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&e.value?null===e||void 0===e?void 0:e.value:" - "})})}else if("recipient"===(null===e||void 0===e?void 0:e.column.Header))t=(0,E.jsx)(d.E,{me:"10px",color:l,fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&e.value?null===e||void 0===e?void 0:e.value:" - "});else if("Realeted To"===(null===e||void 0===e?void 0:e.column.Header)){var r,c,u,h,x,m,p,j;t=(0,E.jsx)(y.N_,{to:null!==e&&void 0!==e&&null!==(r=e.row)&&void 0!==r&&null!==(c=r.original)&&void 0!==c&&c.createBy?"admin"!==(null===B||void 0===B?void 0:B.role)?`/contactView/${null===e||void 0===e||null===(u=e.row)||void 0===u?void 0:u.original.createBy}`:`/admin/contactView/${null===e||void 0===e||null===(h=e.row)||void 0===h?void 0:h.original.createBy}`:"admin"!==(null===B||void 0===B?void 0:B.role)?`/leadView/${null===e||void 0===e||null===(x=e.row)||void 0===x?void 0:x.original.createByLead}`:`/admin/leadView/${null===e||void 0===e||null===(m=e.row)||void 0===m?void 0:m.original.createByLead}`,children:(0,E.jsx)(d.E,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"green.400",fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&null!==(p=e.row)&&void 0!==p&&p.original.createBy?"contact":(null===e||void 0===e||null===(j=e.row)||void 0===j?void 0:j.original.createByLead)&&"lead"})})}else if("timestamp"===(null===e||void 0===e?void 0:e.column.Header))t=(0,E.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e?void 0:e.value).toNow()});else if("Created"===(null===e||void 0===e?void 0:e.column.Header)){var f;t=(0,E.jsx)(d.E,{color:l,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e||null===(f=e.row)||void 0===f?void 0:f.values.timestamp).format("(DD/MM) h:mma")})}return(0,g.createElement)(v.Td,{...null===e||void 0===e?void 0:e.getCellProps(),key:a,fontSize:{sm:"14px"},minW:{sm:"150px",md:"200px",lg:"auto"},borderColor:"transparent"},t)})))}))})]})}),(null===o||void 0===o?void 0:o.length)>5&&(0,E.jsx)(b.A,{gotoPage:F,gopageValue:A,setGopageValue:L,pageCount:R,canPreviousPage:_,previousPage:M,canNextPage:k,pageOptions:I,setPageSize:J,nextPage:G,pageSize:Y,pageIndex:X})]})}var z=l(7492),A=l(8460),L=l(1054),W=l(5421),P=l(5071),$=l(5929),O=l(7516),T=l(6668),V=l(6686),_=l(9904),k=l(4812),I=l(1724),R=l(2703),F=l(5699),G=l(9077),M=l(6529),J=l(9565),X=l(1125),Y=l(3516),K=l(3388),U=l(6092);const Z=e=>{const{onClose:a,isOpen:l,fetchData:t}=e,[r,c]=(0,g.useState)(!1),[u,h]=(0,g.useState)([]),[x,m]=(0,g.useState)(!1),[p,v]=(0,g.useState)(!1),j=JSON.parse(localStorage.getItem("user")),f={sender:null===j||void 0===j?void 0:j._id,recipient:"",callDuration:"",callNotes:"",createBy:"",createByLead:"",startDate:(new Date).toISOString().slice(0,16),endDate:"",category:"contact",assignmentTo:"",assignmentToLead:""},S=(0,Y.Wx)({initialValues:f,validationSchema:U.Ar,onSubmit:async(e,a)=>{let{resetForm:l}=a;await z(e),l()}}),{errors:y,touched:C,values:b,handleBlur:w,handleChange:B,handleSubmit:N,setFieldValue:H}=S,z=async a=>{try{c(!0);200===(await(0,D.d_)("api/phoneCall/add",a)).status&&(e.onClose(),t())}catch(l){console.error(l)}finally{c(!1)}};(0,g.useEffect)((()=>{(async()=>{try{var e;let a;"contact"===b.category?a=await(0,D.x4)("admin"===j.role?"api/contact/":`api/contact/?createBy=${j._id}`):"lead"===b.category&&(a=await(0,D.x4)("admin"===j.role?"api/lead/":`api/lead/?createBy=${j._id}`)),h(null===(e=a)||void 0===e?void 0:e.data)}catch(a){console.error(a)}})()}),[b.category,j._id,j.role]);return(0,g.useEffect)((()=>{(async()=>{try{if(b.createBy){const l=await(0,D.x4)(`api/contact/view/${b.createBy}`);var e,a;200===(null===l||void 0===l?void 0:l.status)&&H("recipient",null===l||void 0===l||null===(e=l.data)||void 0===e||null===(a=e.contact)||void 0===a?void 0:a.phoneNumber)}else if(b.createByLead){const e=await(0,D.x4)(`api/lead/view/${b.createByLead}`);var l,t;200===(null===e||void 0===e?void 0:e.status)&&H("recipient",null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.lead)||void 0===t?void 0:t.leadPhoneNumber)}}catch(n){console.error(n)}})()}),[b.createBy,b.createByLead]),(0,E.jsxs)(A.aF,{onClose:a,isOpen:l,isCentered:!0,children:[(0,E.jsx)(L.m,{}),(0,E.jsxs)(W.$,{children:[(0,E.jsx)(P.r,{children:"Add Call"}),(0,E.jsx)($.s,{}),(0,E.jsxs)(O.c,{children:[(0,E.jsx)(J.A,{isOpen:x,onClose:m,fieldName:"createBy",setFieldValue:H}),(0,E.jsx)(X.A,{isOpen:p,onClose:v,fieldName:"createByLead",setFieldValue:H}),(0,E.jsxs)(n.x,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,E.jsxs)(o.E,{colSpan:{base:12,md:6},children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Related"}),(0,E.jsx)(V.z,{onChange:e=>{H("category",e),H("createBy",""),H("createByLead","")},value:b.category,children:(0,E.jsxs)(_.B,{direction:"row",children:[(0,E.jsx)(k.s,{value:"contact",children:"Contact"}),(0,E.jsx)(k.s,{value:"lead",children:"Lead"})]})}),y.category&&C.category&&(0,E.jsx)(d.E,{color:"red",children:y.category})]}),(0,E.jsx)(o.E,{colSpan:12,children:"contact"===b.category?(0,E.jsxs)(o.E,{colSpan:12,children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Contact)"}),(0,E.jsxs)(s.s,{justifyContent:"space-between",children:[(0,E.jsx)(I.l,{value:b.createBy,name:"createBy",onChange:B,fontWeight:"500",placeholder:"Assignment To",borderColor:y.createBy&&C.createBy?"red.300":null,children:u.map((e=>(0,E.jsx)("option",{value:e._id,children:`${e.firstName} ${e.lastName}`},e._id)))}),(0,E.jsx)(R.K,{onClick:()=>m(!0),ml:2,icon:(0,E.jsx)(K.G2h,{})})]}),y.createBy&&C.createBy&&(0,E.jsx)(d.E,{color:"red",children:y.createBy})]}):"lead"===b.category&&(0,E.jsxs)(o.E,{colSpan:12,children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Lead)"}),(0,E.jsxs)(s.s,{justifyContent:"space-between",children:[(0,E.jsx)(I.l,{value:b.createByLead,name:"createByLead",onChange:B,fontWeight:"500",placeholder:"Assignment To",borderColor:y.createByLead&&C.createByLead?"red.300":null,children:u.map((e=>(0,E.jsx)("option",{value:e._id,children:e.leadName},e._id)))}),(0,E.jsx)(R.K,{onClick:()=>v(!0),ml:2,icon:(0,E.jsx)(K.G2h,{})})]}),y.createByLead&&C.createByLead&&(0,E.jsx)(d.E,{color:"red",children:y.createByLead})]})}),(0,E.jsxs)(o.E,{colSpan:12,children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient"}),(0,E.jsx)(F.p,{fontSize:"sm",value:b.recipient,name:"recipient",placeholder:"Recipient",fontWeight:"500",disabled:!0,borderColor:y.recipient&&C.recipient?"red.300":null})]}),(0,E.jsxs)(o.E,{colSpan:{base:12,md:6},children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Start Date"}),(0,E.jsx)(F.p,{type:"datetime-local",name:"startDate",value:b.startDate,onChange:B,onBlur:w,fontSize:"sm",fontWeight:"500",borderColor:y.startDate&&C.startDate?"red.300":null}),y.startDate&&C.startDate&&(0,E.jsx)(d.E,{color:"red",children:y.startDate})]}),(0,E.jsxs)(o.E,{colSpan:{base:12,md:6},children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"End Date"}),(0,E.jsx)(F.p,{type:"datetime-local",name:"endDate",value:b.endDate,onChange:B,onBlur:w,fontSize:"sm",fontWeight:"500",borderColor:y.endDate&&C.endDate?"red.300":null}),y.endDate&&C.endDate&&(0,E.jsx)(d.E,{color:"red",children:y.endDate})]}),(0,E.jsxs)(o.E,{colSpan:{base:12,md:6},children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Call Duration"}),(0,E.jsx)(F.p,{name:"callDuration",value:b.callDuration,onChange:B,onBlur:w,fontSize:"sm",fontWeight:"500",borderColor:y.callDuration&&C.callDuration?"red.300":null}),y.callDuration&&C.callDuration&&(0,E.jsx)(d.E,{color:"red",children:y.callDuration})]}),(0,E.jsxs)(o.E,{colSpan:{base:12,md:6},children:[(0,E.jsx)(T.l,{fontSize:"sm",fontWeight:"500",mb:"8px",children:"Call Notes"}),(0,E.jsx)(G.T,{name:"callNotes",value:b.callNotes,onChange:B,onBlur:w,fontSize:"sm",fontWeight:"500",borderColor:y.callNotes&&C.callNotes?"red.300":null}),y.callNotes&&C.callNotes&&(0,E.jsx)(d.E,{color:"red",children:y.callNotes})]})]})]}),(0,E.jsxs)(M.j,{children:[(0,E.jsx)(i.$,{colorScheme:"blue",mr:3,onClick:N,isLoading:r,loadingText:"Submitting",children:"Submit"}),(0,E.jsx)(i.$,{variant:"ghost",onClick:a,children:"Cancel"})]})]})]})},q=()=>{const{isOpen:e,onOpen:a,onClose:l}=(0,t.j)();return(0,E.jsxs)("div",{children:[(0,E.jsx)(n.x,{templateColumns:"repeat(6, 1fr)",mb:3,gap:1,children:(0,E.jsx)(o.E,{colStart:6,textAlign:"right",children:(0,E.jsx)(i.$,{onClick:a,leftIcon:(0,E.jsx)(z.R,{}),variant:"brand",children:"Add"})})}),(0,E.jsx)(H,{isOpen:e,columnsData:[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"Sender",accessor:"senderName"},{Header:"Recipient",accessor:"createByName"},{Header:"Related To"},{Header:"Timestamp",accessor:"timestamp"},{Header:"Created"}]}),(0,E.jsx)(Z,{isOpen:e,size:"lg",onClose:l})]})}},7492:(e,a,l)=>{l.d(a,{R:()=>t});const t=(0,l(4010).w)({d:"M0,12a1.5,1.5,0,0,0,1.5,1.5h8.75a.25.25,0,0,1,.25.25V22.5a1.5,1.5,0,0,0,3,0V13.75a.25.25,0,0,1,.25-.25H22.5a1.5,1.5,0,0,0,0-3H13.75a.25.25,0,0,1-.25-.25V1.5a1.5,1.5,0,0,0-3,0v8.75a.25.25,0,0,1-.25.25H1.5A1.5,1.5,0,0,0,0,12Z",displayName:"AddIcon"})}}]);
//# sourceMappingURL=1929.bbdffcb7.chunk.js.map